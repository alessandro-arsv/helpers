local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

local Icons = {
    Error = "rbxassetid://5107154082",
    Success = "rbxassetid://8266856324",
    Warning = "rbxassetid://85147473315465"
}

local Colors = {
    Error = Color3.fromRGB(255, 80, 80),
    Success = Color3.fromRGB(80, 255, 150),
    Warning = Color3.fromRGB(255, 200, 80),
    Default = Color3.fromRGB(0, 170, 255)
}

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "AdvancedNotificationGui"
ScreenGui.Parent = CoreGui
ScreenGui.ResetOnSpawn = false

local Holder = Instance.new("Frame")
Holder.Name = "Holder"
Holder.Size = UDim2.new(0, 320, 1, -40)
Holder.Position = UDim2.new(1, -10, 1, -20)
Holder.AnchorPoint = Vector2.new(1, 1)
Holder.BackgroundTransparency = 1
Holder.Parent = ScreenGui

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 10)
UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Right
UIListLayout.VerticalAlignment = Enum.VerticalAlignment.Bottom
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = Holder

local function CreateNotification(title, msg, type, duration)
    duration = duration or 5
    type = type or "Success"
    local accentColor = Colors[type] or Colors.Default

    local Notif = Instance.new("Frame")
    Notif.Name = "Notification"
    Notif.Size = UDim2.new(0, 300, 0, 80)
    Notif.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    Notif.BackgroundTransparency = 0.1
    Notif.BorderSizePixel = 0
    Notif.ClipsDescendants = true
    Notif.Parent = Holder
    Notif.LayoutOrder = -os.time()
    
    Notif.Position = UDim2.new(1, 350, 0, 0)

    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 8)
    UICorner.Parent = Notif

    local UIStroke = Instance.new("UIStroke")
    UIStroke.Thickness = 1.5
    UIStroke.Color = accentColor
    UIStroke.Transparency = 0.6
    UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    UIStroke.Parent = Notif

    local UIGradient = Instance.new("UIGradient")
    UIGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 255, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(150, 150, 150))
    })
    UIGradient.Rotation = 45
    UIGradient.Parent = Notif

    local Icon = Instance.new("ImageLabel")
    Icon.Name = "Icon"
    Icon.Size = UDim2.new(0, 30, 0, 30)
    Icon.Position = UDim2.new(0, 12, 0.5, -15)
    Icon.BackgroundTransparency = 1
    Icon.Image = Icons[type] or Icons.Success
    Icon.ImageColor3 = accentColor
    Icon.Parent = Notif

    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Name = "Title"
    TitleLabel.Size = UDim2.new(1, -60, 0, 20)
    TitleLabel.Position = UDim2.new(0, 52, 0, 12)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Text = title
    TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.TextSize = 15
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.RichText = true
    TitleLabel.Parent = Notif

    local DescLabel = Instance.new("TextLabel")
    DescLabel.Name = "Description"
    DescLabel.Size = UDim2.new(1, -60, 0, 35)
    DescLabel.Position = UDim2.new(0, 52, 0, 32)
    DescLabel.BackgroundTransparency = 1
    DescLabel.Text = msg
    DescLabel.TextColor3 = Color3.fromRGB(220, 220, 220)
    DescLabel.Font = Enum.Font.Gotham
    DescLabel.TextSize = 13
    DescLabel.TextXAlignment = Enum.TextXAlignment.Left
    DescLabel.TextYAlignment = Enum.TextYAlignment.Top
    DescLabel.TextWrapped = true
    DescLabel.RichText = true
    DescLabel.Parent = Notif

    local TimerBG = Instance.new("Frame")
    TimerBG.Name = "TimerBG"
    TimerBG.Size = UDim2.new(1, 0, 0, 3)
    TimerBG.Position = UDim2.new(0, 0, 1, -3)
    TimerBG.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    TimerBG.BackgroundTransparency = 0.9
    TimerBG.BorderSizePixel = 0
    TimerBG.Parent = Notif

    local TimeBar = Instance.new("Frame")
    TimeBar.Name = "TimeBar"
    TimeBar.Size = UDim2.new(1, 0, 1, 0)
    TimeBar.BackgroundColor3 = accentColor
    TimeBar.BorderSizePixel = 0
    TimeBar.Parent = TimerBG

    TweenService:Create(Notif, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Position = UDim2.new(0, 0, 0, 0)
    }):Play()

    local Sound = Instance.new("Sound")
    Sound.SoundId = "rbxassetid://4590657391"
    Sound.Volume = 0.5
    Sound.Parent = CoreGui
    Sound:Play()
    game:GetService("Debris"):AddItem(Sound, 2)

    local barTween = TweenService:Create(TimeBar, TweenInfo.new(duration, Enum.EasingStyle.Linear), {
        Size = UDim2.new(0, 0, 1, 0)
    })
    barTween:Play()

    task.delay(duration, function()
        local exitTween = TweenService:Create(Notif, TweenInfo.new(0.4, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
            Position = UDim2.new(1, 350, 0, 0),
            BackgroundTransparency = 1
        })
        exitTween:Play()
        exitTween.Completed:Connect(function()
            local shrink = TweenService:Create(Notif, TweenInfo.new(0.3), {Size = UDim2.new(0, 300, 0, 0)})
            shrink:Play()
            shrink.Completed:Connect(function()
                Notif:Destroy()
            end)
        end)
    end)
end

return CreateNotification
